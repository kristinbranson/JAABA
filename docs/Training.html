<!DOCTYPE html>
<html>
<head>
<style type="text/css">
table {
background-color:yellow;border-collapse:collapse;
}
table, td
{
padding:3px;
}
table, th{
padding:3px; background-color:orange;color:white;
}
table, tr
{
padding:3px; background-color:yellow;color:black;

}
</style>
</head>
</body>
<center><h1> Training a Classifier </h1></center>

<h3> TRAINING and REVIEWING </h3>

<p>Once you have labeled a few bouts of both behavior and none (i.e., not
behavior), you can train a classifier by using the <b>Train</b> button.
The first time you train a classifier, JAABA will pop-up the <b>Select
Features</b> interface and ask you to pick up the features.  
</p>

</center><table style="border:0px; width:50%"; >
<tr style="padding:3px; background-color:white;color:black;">
<td><center><a href="images/selectFeautresInitial.png"><img src="images/selectFeaturesInitial.png"
height="500px"/></a></center></td>
<td><center><a href="images/SelectFeaturesSel.png"><img
src="images/SelectFeaturesSel.png"
height="500px"/></a></center></td>
</tr>
</table></center>


<p> To start quickly, select or deselect categories of per-frame by selecting
<b>all</b> or <b>none</b> from the drop-down menu in the table. Also set the
<b>Window Size</b> to a positive integer.</p>

<p> You can then hit to use those per-frame features to train the detector. If
you didn't specify a file in the projects configuration in the parameter
<b>file.featureparamfilename</b>, then it'll ask for a location to save the
settings you selected. The parameter <b>file.featureparamfilename</b> will be
updated in the project configuration file to point to this location. More
details on perframe features, window computations and window size can be found 
<a href=WindowFeatureComputation.html>here</a>.
</p>

<p>
For frames around manual labels, JAABA will automatically show the predictions.
To see the classifier's predictions on frames without predictions, use the
<b>Predict</b> button. This will find the predictions for some number of
frames around the current frame. If you <b>play</b> the movie, JAABA will predict the
behavior for frames as they appear. The prediction isn't done for the whole
trajectory but only on certain frames around the current frame.
</p>


<center><img src="images/Automatic-Tracks.png" width="700"></center>

<p>The classifier's predictions are shown on the automatic predictions timeline
which has four parts. The top two rows always show the predictions and scores of
the current classifier. The classifier's scores roughly correspond to the
classifier's confidence. Dark colors close to black indicate low confidence,
	while brighter colors indicate high confidence. What is shown in the bottom
	two rows can be set using the drop down menu on the left. It can show
	predictions and scores of the previous classifier, the results of
	cross-validation, or loaded scores. </p>

<h3> MEMORY USAGE </h3>

To both train and predict, for each frame we compute an extensive set of window feature. The number of feature values for each frame can be in the thousands. Computing the feature values takes time and requires a lot of memory, so we compute them as and when necessary, but once computed we try to store them as long as possible until the memory used to store them hits a limit. Window features are computed for frames that are around frames that have labels or predictions. The amount of memory that is used for window features can be controlled by <b>Edit -> Memory Usage</b>.

<h3> RETRAINING </h3>

<p>As you review the predictions, you can label frames whose class is incorrectly predicted. It's likely that the classifier's predictions are wrong on these frames because there were no or very few such frames in the training set. Adding such frames to the training set improves the classifier's prediction on similar frames. Once you add new labels, you can retrain the classifier by clicking <b>Train</b> again. After retraining, the scores from the previous classifier can be shown at the bottom of the automatic predictions timeline (<b>old</b> in the drop down menu). 
</p>

<h3> LABELING GUIDELINES </h3>

<p>Machine learning algorithms are sensitive to inconsistent labels. To help in
learning an accurate detector, you should not label frames for which you are unsure of the behavior. There is a tendency to label these frames inconsistently and with such data it is difficult for learning algorithms to find a good classifier because most of the effort is spent separating similar looking examples. The other advantage is that labeling is faster and easier because it takes longer to decide on labels for such difficult examples.</p>

<p>Machine learning algorithms also find it difficult to train an accurate classifier if the number of examples from both classes are unbalanced. To create a more balanced training set, once you train an initial classifier, you should try to label only examples that are incorrectly predicted or get low scores, and train often. This strategy reduces the addition of obvious examples that make up most of the "not" behavior from bloating the training set and thus resulting in a healthier balance of positive and negative examples in the training set.</p>


</body></html>
