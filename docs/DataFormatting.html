<!DOCTYPE html>
<html>
<head>
<style type="text/css">
table {
background-color:yellow;border:1px dotted black;width:80%;border-collapse:collapse;
}
table, td
{
padding:3px;
}
table, th{
padding:3px; background-color:orange;color:white;
}
table, tr
{
padding:3px; background-color:yellow;color:black;

}
</style>
</head>

<body>
<center>
<h1> Preparing Data for JAABA </h1>
</center>
<h3> Experiment Directory Structures </h3>

<p>The inputs to JAABA are the experimental video and the animal's trajectories
in the videos. JAABA requires that each experiment's data (video and the tracks
file) be stored in separate directories. JAABA uses the directory's name
as the name of the experiment. The filename for the movies (or the video) for
different experiments should have the same name (e.g., movie.avi). Same is the
case for the tracks file. JAABA can open avi, seq, mmf, fmf, sbfmf, ufmf video formats.
</p>

<p>The screenshots shows 2 JAABA experiments:
pBDPGAL4U_TrpA_Rig1Plate15BowlB_20110922T145928 and
 pBDPGAL4U_TrpA_Rig2Plate14BowlD_20110615T164545. movie.ufmf is the video of the
 experiment, trx.mat has the tracking information, directory perframe contains
 the per-frame data that is generated by JAABA and labeledChases.mat is the file
 that contains the information about which trajectories were labeled as chases
 by the user in JAABA. movie.ufmf and trx.mat are inputs to JAABA
 while the per-frame and the labeledChases.mat are created by JAABA.</p>

</center><table style=""; >
<tr style="padding:3px; background-color:white;color:black;">
<td><a href="images/dirStructure.png"><img src="images/dirStructure.png"
width="600px"/></a></td>
<td><a href="images/dirStructure-perframe.png"><img
src="images/dirStructure-perframe.png"
width="600px"/></a></td>
</tr>
</table></center>



<h3> Tracks File Structure </h3>
</p>
 The tracking information is given in trxfile which is a MATLAB .mat file. The
 trxfile can be the output file from CTRAX or you
can convert the output of other tracking programs into JAABA compatible format.
The trxfile has one variable: "trx". "trx" is a matlab structure array 
where each element corresponds to an animal. The details of
structure fields are listed in the table below.</p>

<center><table border="1">
<th >Structure Field</th><th >Details</th>
</tr>
<tr> <td >nframes</td><td >number of frames in the trajectory of the current animal.</td> </tr>
<tr> <td >firstframe</td><td >first frame of the animal's trajectory.</td> </tr>
<tr> <td >endframe</td><td >last frame of the animal's trajectory.</td> </tr>
<tr> <td >id</td><td >a non-negative integer that gives the identity number of the trajectory.</td> </tr>
<tr> <td >x</td><td >x coordinate of the animal in pixels.</td> </tr>
<tr> <td >y</td><td >y coordinate of the animal in pixels.</td> </tr>
<tr> <td >theta</td><td >orientation of the animal.</td> </tr>
<tr> <td >a</td><td >1/4 of the major-axis length in pixels.</td> </tr>
<tr> <td >b</td><td >1/4 of the minor-axis length in pixels.</td> </tr>
<tr> <td >x_mm</td><td >x coordinate of the animal in mm.</td> </tr>
<tr> <td >y_mm</td><td >y coordinate of the animal in mm.</td> </tr>
<tr> <td >theta_mm</td><td >orientation of the animal. This is same as theta.</td> </tr>
<tr> <td >a_mm</td><td >1/4 of the major-axis length in mm.</td> </tr>
<tr> <td >b_mm</td><td >1/4 of the major-axis length in mm.</td> </tr>
<tr> <td >sex</td><td >sex of the animal. Can be just one value ('M' or 'F' or '?') or can be a cell array of 'M' and 'F' giving the sex for each frame. The size of cell array should be nframes.</td> </tr>
<tr> <td >dt</td><td >time difference between the current frame and previous
frame in seconds.</td> </tr>
<tr> <td >moviename</td><td >movie on which tracking was done. Can be '?' to denote unknown.</td> </tr>
<tr> <td >timestamps</td><td >timestamp of each frame. The time is represented
as Matlab serial date number, which is the number of days (including
    fractional days) since a particular reference time.  The reference
    time is defined such that midnight on the morning of January 1,
    0000 has a serial date number of 0, midnight of the morning of January 2,
	0000 has a serial data of 1, etc. (The year
    0000 is defined in ISO 8601:2004 and corresponds to the Gregorian
    year 1 BC.  Year 0001 corresponds to the Gregorian year 1 AD.)
More information can be found <a
href="http://www.mathworks.com/help/techdoc/ref/datestr.html">here</a>. </td> </tr>
</table></center>

<p>Below is a screenshot of the matlab command window showing the trx
variable.</p>
<center><img src="images/trx_matlab_workspace.png"></center>
<p>The optional variable "timestamp" in the trxfile gives timestamps for each
frame of the movie, represented as a serial date number (described in 
the table above). </p>


</body>
</html>
